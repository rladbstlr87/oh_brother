# 교회 행사 정보 통합 플랫폼 '오늘의 교회' (Oh-Brother)

### 프로젝트 개요

- **한 줄 소개**: 흩어져 있는 교회들의 다양한 행사(특별 집회, 수련회, 결혼식 등) 정보를 한곳에 모아 보여주는 웹 서비스 및 모바일 앱 백엔드 시스템
- **개발 기간**: YYYY.MM.DD ~ YYYY.MM.DD
- **핵심 목표**:
    - 각 교회 웹사이트에 게시되는 다양한 형식의 공문(PDF, HWP, DOCX, 이미지 등)을 수집 및 분석
    - 정형/비정형 데이터에서 행사명, 날짜, 장소, 강사 등 유의미한 정보를 추출하여 DB에 정규화
    - 사용자가 앱/웹을 통해 모든 교회 행사를 쉽게 검색하고 구독할 수 있도록 안정적인 REST API 제공
    - 관리자가 손쉽게 데이터를 검수하고 시스템을 운영할 수 있는 백오피스(T-board) 구축

---

### 주요 기능

- **사용자 기능 (Web/App)**
    - 교회별, 날짜별, 행사 유형별 일정 검색 및 필터링
    - 캘린더 연동을 통한 개인 일정 관리
    - 관심 교회/행사 구독 및 새 소식 푸시 알림
- **관리자 백오피스 (T-Board)**
    - 수집된 행사 정보 검수 및 수정/추가/삭제
    - 공문 원본 파일 관리 및 데이터 추출 결과 모니터링
    - 사용자 통계 및 서비스 운영 현황 대시보드
- **시스템 기능**
    - 지정된 웹사이트의 게시글을 주기적으로 크롤링
    - **(핵심) 공문 분석 및 데이터 추출 시스템**: 다양한 파일 형식(PDF, DOCX, HWP, 이미지)을 지원하는 문서 파서(Parser) 모듈 구현
    - 추출된 데이터를 기반으로 표준화된 행사 정보를 생성하고 저장
    - 모바일 앱과 웹 클라이언트를 위한 RESTful API 서버

---

### 적용 기술

- **Backend**:
    - `Python 3.9+`
    - `Django 4.x`
    - `Django REST Framework(DRF)`: REST API 설계 및 구현
    - `Celery` & `Redis`: 공문 분석, 데이터 추출 등 비동기 처리 및 스케줄링
- **Database**:
    - `MySQL 8.0`: 메인 데이터 저장
    - `Redis`: 캐싱, Celery 메시지 브로커
- **Infrastructure & DevOps**:
    - `Linux (Ubuntu)`: 서버 운영체제
    - `Docker` & `Docker Compose`: 컨테이너 기반 서비스 환경 구축
    - `AWS (EC2, S3, RDS)`: 퍼블릭 클라우드 환경에서의 개발 및 운영
        - `EC2`: 애플리케이션 서버 배포
        - `S3`: 공문 원본 파일 및 미디어 파일 저장
        - `RDS for MySQL`: 관리형 데이터베이스 서비스
- **Data Extraction**:
    - `BeautifulSoup4`, `Selenium`: 웹 크롤링
    - `PyPDF2`, `python-docx`, `pyhwp`: 문서 파일 파싱
    - `Pillow`, `Tesseract OCR`: 이미지 내 텍스트 추출
- **Frontend (유지보수)**:
    - `Vue.js`: 기존 백오피스 코드 이해 및 유지보수

---

### 시스템 아키텍처

```
+------------------+      +-------------------+      +----------------------+
|  Clients         |      |  Web Server       |      |  Application Server  |
| (Web, Mobile App)|----->|  (Nginx)          |----->|  (Gunicorn + Django) |
+------------------+      +-------------------+      +----------------------+
       ^                                                     |        |
       | (REST API)                                          |        | (DB Query)
       |                                                     v        v
+------------------+      +-------------------+      +----------------------+
|  Message Queue   |<-----|  Async Workers    |      |  Database            |
|  (Redis)         |      |  (Celery)         |<---->|  (MySQL on RDS)      |
+------------------+      +-------------------+      +----------------------+
       ^                                                     ^
       | (Task)                                              | (File Storage)
       |                                                     |
+--------------------------------+                           |
|  Document Parser & Extractor   |-------------------------->|  File Storage (AWS S3) |
+--------------------------------+                           +------------------------+

```
1. **데이터 수집**: Celery Beat가 주기적으로 크롤러 Worker를 실행시켜 각 교회 사이트의 공문 파일을 수집 후 S3에 저장
2. **데이터 추출**: 파일 저장이 완료되면 Celery Worker가 해당 파일을 S3에서 읽어와 파일 형식에 맞는 Parser를 통해 텍스트 및 메타데이터 추출
3. **데이터 저장**: 추출된 정보는 Django ORM을 통해 정규화되어 RDS(MySQL)에 저장
4. **API 제공**: 클라이언트(웹/앱)의 요청이 Nginx를 통해 들어오면 Gunicorn/Django 서버가 DB의 정보를 바탕으로 REST API 응답을 생성하여 전달
5. **백오피스**: 관리자는 웹 기반 백오피스를 통해 1-4 과정의 모든 데이터를 조회하고 관리

---

### 경험 및 배운 점

- **다양한 공문 형식 대응의 어려움 및 해결**:
    - **문제**: 교회마다 사용하는 공문 양식과 파일 형식이 모두 달라 표준화된 데이터 추출이 어려웠음, 특히 HWP 파일과 이미지 기반 PDF 처리가 가장 큰 난관
    - **해결**:
        1. 파일 확장자별로 처리 로직을 분기하는 `Parser` 추상 클래스를 설계하고, 각 형식에 맞는 `PDFParser`, `DocxParser`, `HwpParser`, `ImageParser` 등을 구현하여 확장성을 확보
        2. 비동기 태스크 큐 `Celery`를 도입하여, 시간이 오래 걸리는 파일 분석 작업을 백그라운드에서 처리하도록 구성, 이를 통해 웹 서버의 부하를 줄이고 사용자 요청에 대한 응답 시간 단축
        3. OCR(Tesseract)의 낮은 한국어 인식률을 개선하기 위해 이미지 전처리(Thresholding, Denoising) 단계를 추가하여 정확도를 약 20% 향상
- **REST API 설계 및 최적화**:
    - **문제**: 행사 데이터 조회 시 불필요한 DB Query가 과도하게 발생하여 응답 속도가 저하되는 N+1 문제 발생
    - **해결**: Django ORM의 `select_related`와 `prefetch_related`를 적극적으로 활용하여 쿼리 수를 최적화했으며, DRF의 `Serializer` 커스터마이징을 통해 API 응답 데이터의 형태를 클라이언트에 맞게 가공
- **컨테이너 기반의 개발 및 배포 환경 구축**:
    - **문제**: 로컬 개발 환경과 실제 서버 환경의 차이로 인해 배포 시 예상치 못한 오류가 발생하는 문제
    - **해결**: `Docker`를 사용해 개발, 테스트, 프로덕션 환경을 모두 컨테이너화하여 일관성을 유지, `Docker Compose`를 통해 Django, Nginx, Celery, Redis 등 여러 서비스의 의존성을 관리하고 손쉽게 전체 시스템을 실행할 수 있도록 구성

---

### 추후 개선 계획

- **데이터 추출 정확도 향상**: 정규표현식과 키워드 매칭을 넘어, `KoNLPy` 등 자연어 처리(NLP) 라이브러리를 도입하여 문맥을 이해하고 더 정확하게 정보를 추출하는 모델 개발
- **모바일 앱 개발**: 백엔드 API를 활용하여 `Flutter` 또는 `React Native` 기반의 크로스플랫폼 모바일 앱 개발 착수
- **사용자 맞춤 추천 기능**: 사용자의 검색 이력, 구독 정보 등을 바탕으로 관심 가질 만한 행사를 추천하는 알고리즘 구현
